# Cloudflare Workers configuration for 1000words
# Deploy with: wrangler deploy

name = "1000words"
main = "../../build/worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Production environment
[env.production]
name = "1000words"
routes = [
  { pattern = "1000words.page/*", zone_name = "1000words.page" }
]

# Staging environment
[env.staging]
name = "1000words-staging"

# R2 bucket for story storage
[[r2_buckets]]
binding = "STORY_BUCKET"
bucket_name = "1000words-stories"
preview_bucket_name = "1000words-stories-preview"

# D1 database for story metadata
[[d1_databases]]
binding = "DB"
database_name = "1000words"
database_id = "f0a81b4a-ce67-4bec-8c0c-a5a928c03592"

# Environment variables
[vars]
ENVIRONMENT = "production"

# Build configuration
[build]
command = "npm run build:cloudflare"

# Site configuration for static assets
[site]
bucket = "../../build/client"

# Observability
[observability]
enabled = true
